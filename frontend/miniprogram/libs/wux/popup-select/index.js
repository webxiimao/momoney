"use strict";var _baseComponent=_interopRequireDefault(require("../helpers/baseComponent")),_popupMixin=_interopRequireDefault(require("../helpers/popupMixin")),_utils=require("./utils");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ownKeys(t,e){var i,a=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,i)),a}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(i),!0).forEach(function(e){_defineProperty(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}(0,_baseComponent.default)({behaviors:[(0,_popupMixin.default)("#wux-select")],properties:{prefixCls:{type:String,value:"wux-select"},value:{type:[String,Array],value:""},options:{type:Array,value:[]},multiple:{type:Boolean,value:!1},max:{type:Number,value:-1}},data:{scrollTop:0},observers:_defineProperty({},"options, multiple",function(e,t){this.setData({inputValue:this.getRealValue(e,this.data.inputValue,t)})}),methods:{getRealValue:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.data.options,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.data.inputValue,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.data.multiple;return(0,_utils.getRealValue)(e,t,i)},updated:function(e,t){this.hasFieldDecorator&&!t||(e=this.getRealValue(this.data.options,e),this.data.inputValue!==e&&this.setData({inputValue:e}))},setVisibleState:function(i){var a,n=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};this.data.popupVisible!==i&&(a={mounted:!0,inputValue:this.getRealValue(this.data.options,this.data.value),popupVisible:i},this.setData(i?a:{popupVisible:i},function(){var t,e;i&&(t=a.inputValue,e=n.getFieldElem(),n.hasFieldDecorator&&e&&(t=e.data.value,e.changeValue(t)),n.getBoundingClientRect(function(e){n.scrollIntoView(t,e)})),r()}))},onValueChange:function(e){var t,i,a;this.data.mounted&&((a=this.data).options,t=a.max,i=a.multiple,a=e.detail.selectedValue,i&&1<=t&&t<a.length||(this.setScrollValue(a),this.updated(a,!0),this.triggerEvent("valueChange",this.formatPickerValue(_objectSpread(_objectSpread({},e.detail),{},{value:a})))))},scrollIntoView:function(e,t){var i=this.data,a=i.options,i=i.multiple,i=(0,_utils.getSelectIndex)(a,e,i),a=a.length,i=Array.isArray(i)?i[i.length-1]:i;-1!==i&&void 0!==i||(i=0);i=1<=a?parseFloat(t/a*i):0;this.data.scrollTop!==i&&this.setData({scrollTop:i})},getBoundingClientRect:function(e){return this.selectComponent("#wux-select").getBoundingClientRect(e)}}});