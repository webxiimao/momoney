"use strict";var _baseComponent=_interopRequireDefault(require("../helpers/baseComponent")),_classNames=_interopRequireDefault(require("../helpers/classNames"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ownKeys(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)),n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(r="Object"===r&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var defaults={prefixCls:"wux-keyboard",className:"",titleText:"安全键盘",cancelText:"确定",inputText:"输入数字密码",showCancel:!0,disorder:!1,password:!0,maxlength:-1,closeOnReject:!0,onChange:function(t){},callback:function(t){},onSubmit:function(t){}},upsetNums=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[1,2,3,4,5,6,7,8,9,0];if(t)for(var r,n,o,a=Math.floor,i=Math.random,s=e.length,u=a(s/2)+1;u--;)(r=a(i()*s))!==(n=a(i()*s))&&(o=e[r],e[r]=e[n],e[n]=o);for(var c=[],l=0;l<4;l++)c.push(e.slice(3*l,3*(l+1)));return c};(0,_baseComponent.default)({useFunc:!0,data:defaults,computed:{classes:["prefixCls",function(t){return{wrap:(0,_classNames.default)(t),hd:"".concat(t,"__hd"),bd:"".concat(t,"__bd"),label:"".concat(t,"__label"),password:"".concat(t,"__password"),input:"".concat(t,"__input"),ft:"".concat(t,"__ft"),title:"".concat(t,"__title"),numbers:"".concat(t,"__numbers"),number:"".concat(t,"__number"),text:"".concat(t,"__text"),hover:"".concat(t,"__text--hover")}}]},methods:{hide:function(){this.$$setData({in:!1})},submit:function(){var t=this.data.value;this.$$setData({in:!1}),"function"==typeof this.fns.onSubmit&&this.fns.onSubmit.call(this,t)},show:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=upsetNums(t.disorder),r=t.maxlength<=0?-1:t.maxlength,r=-1!==r?_toConsumableArray(new Array(r||defaults.maxlength)).map(function(){return 1}):[],t=this.$$mergeOptionsAndBindMethods(Object.assign({nums:e,keys:r,value:""},defaults,t));this.$$setData(_objectSpread({in:!0},t))},increase:function(t){var e=t.currentTarget.dataset,r=String(e.value),t=this.data,e=t.value,t=t.maxlength;e.length>=t&&-1!==t||this.updateValue(e+r)},decrease:function(t){var e=this.data.value;0!==e.length&&this.updateValue(e.substr(0,e.length-1))},updateValue:function(){var t,e,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.$$setData({value:n}),"function"==typeof this.fns.onChange&&this.fns.onChange.call(this,n),n.length===this.data.maxlength&&(t=this.fns.onClose||this.fns.callback,e=this.hide.bind(this),r=this.data.closeOnReject?e:function(){},t&&"function"==typeof t?"object"===_typeof(n=t.call(this,n))?(n.closePromise||n).then(e,r):!1!==n&&e():e())}}});